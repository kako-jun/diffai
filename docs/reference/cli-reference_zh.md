# CLIå‚è€ƒæ‰‹å†Œ

diffai v0.3.4 å®Œæ•´å‘½ä»¤è¡Œå‚è€ƒæ‰‹å†Œ - å…·æœ‰ç®€åŒ–ç•Œé¢çš„AI/MLä¸“ç”¨å·®åˆ†å·¥å…·

## å‘½ä»¤æ¦‚è¦

```
diffai [é€‰é¡¹] <è¾“å…¥æ–‡ä»¶1> <è¾“å…¥æ–‡ä»¶2>
```

## æè¿°

diffaiæ˜¯ä¸“é—¨ä¸ºAI/MLå·¥ä½œæµè®¾è®¡çš„å·®åˆ†å·¥å…·ï¼Œèƒ½å¤Ÿç†è§£æ¨¡å‹ç»“æ„ã€å¼ é‡ç»Ÿè®¡å’Œç§‘å­¦æ•°æ®ã€‚å®ƒæ¯”è¾ƒPyTorchæ¨¡å‹ã€Safetensorsæ–‡ä»¶ã€NumPyæ•°ç»„ã€MATLABçŸ©é˜µå’Œç»“æ„åŒ–æ•°æ®æ–‡ä»¶ï¼Œä¸“æ³¨äºè¯­ä¹‰å˜åŒ–è€Œéæ ¼å¼å·®å¼‚ã€‚

## å‚æ•°

### å¿…éœ€å‚æ•°

#### `<è¾“å…¥æ–‡ä»¶1>`
ç¬¬ä¸€ä¸ªè¦æ¯”è¾ƒçš„è¾“å…¥æ–‡ä»¶æˆ–ç›®å½•

- **ç±»å‹**: æ–‡ä»¶è·¯å¾„æˆ–ç›®å½•è·¯å¾„
- **æ ¼å¼**: PyTorch (.pt/.pth)ã€Safetensors (.safetensors)ã€NumPy (.npy/.npz)ã€MATLAB (.mat)ã€JSONã€YAMLã€TOMLã€XMLã€INIã€CSV
- **ç‰¹æ®Šç”¨æ³•**: ä½¿ç”¨ `-` è¡¨ç¤ºä»æ ‡å‡†è¾“å…¥è¯»å–

#### `<è¾“å…¥æ–‡ä»¶2>`
ç¬¬äºŒä¸ªè¦æ¯”è¾ƒçš„è¾“å…¥æ–‡ä»¶æˆ–ç›®å½•

- **ç±»å‹**: æ–‡ä»¶è·¯å¾„æˆ–ç›®å½•è·¯å¾„
- **æ ¼å¼**: ä¸è¾“å…¥æ–‡ä»¶1ç›¸åŒ
- **ç‰¹æ®Šç”¨æ³•**: ä½¿ç”¨ `-` è¡¨ç¤ºä»æ ‡å‡†è¾“å…¥è¯»å–

**ç¤ºä¾‹**:
```bash
diffai model1.safetensors model2.safetensors
diffai data_v1.npy data_v2.npy
diffai experiment_v1.mat experiment_v2.mat
diffai config.json config_new.json
diffai - config.json < input.json
```

## é€‰é¡¹

### åŸºæœ¬é€‰é¡¹

#### `-f, --format <æ ¼å¼>`
æ˜¾å¼æŒ‡å®šè¾“å…¥æ–‡ä»¶æ ¼å¼

- **å¯èƒ½çš„å€¼**: `json`ã€`yaml`ã€`toml`ã€`ini`ã€`xml`ã€`csv`ã€`safetensors`ã€`pytorch`ã€`numpy`ã€`npz`ã€`matlab`
- **é»˜è®¤å€¼**: ä»æ–‡ä»¶æ‰©å±•åè‡ªåŠ¨æ£€æµ‹
- **ç¤ºä¾‹**: `--format safetensors`

#### `-o, --output <è¾“å‡ºæ ¼å¼>`
é€‰æ‹©è¾“å‡ºæ ¼å¼

- **å¯èƒ½çš„å€¼**: `cli`ã€`json`ã€`yaml`ã€`unified`
- **é»˜è®¤å€¼**: `cli`
- **ç¤ºä¾‹**: `--output json`

#### `-r, --recursive`
é€’å½’æ¯”è¾ƒç›®å½•

- **ç¤ºä¾‹**: `diffai dir1/ dir2/ --recursive`


### é«˜çº§é€‰é¡¹

#### `--path <è·¯å¾„>`
æŒ‰ç‰¹å®šè·¯å¾„è¿‡æ»¤å·®å¼‚

- **ç¤ºä¾‹**: `--path "config.users[0].name"`
- **æ ¼å¼**: ç±»JSONPathè¯­æ³•

#### `--ignore-keys-regex <æ­£åˆ™è¡¨è¾¾å¼>`
å¿½ç•¥åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼çš„é”®

- **ç¤ºä¾‹**: `--ignore-keys-regex "^id$"`
- **æ ¼å¼**: æ ‡å‡†æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼

#### `--epsilon <æµ®ç‚¹æ•°>`
è®¾ç½®æµ®ç‚¹æ•°æ¯”è¾ƒçš„å®¹å·®

- **ç¤ºä¾‹**: `--epsilon 0.001`
- **é»˜è®¤å€¼**: æœºå™¨ç²¾åº¦

#### `--array-id-key <é”®>`
æŒ‡å®šç”¨äºè¯†åˆ«æ•°ç»„å…ƒç´ çš„é”®

- **ç¤ºä¾‹**: `--array-id-key "id"`
- **ç”¨é€”**: ç”¨äºç»“æ„åŒ–æ•°ç»„æ¯”è¾ƒ

#### `-v, --verbose`
æ˜¾ç¤ºè¯¦ç»†çš„å¤„ç†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ€§èƒ½æŒ‡æ ‡ã€é…ç½®è¯¦æƒ…å’Œè¯Šæ–­è¾“å‡ºã€‚

- **ç¤ºä¾‹**: `diffai model1.safetensors model2.safetensors --verbose`
- **ç”¨é€”**: è°ƒè¯•åˆ†æè¿‡ç¨‹å’Œæ€§èƒ½

#### `--no-color`
ç¦ç”¨å½©è‰²è¾“å‡ºï¼Œä»¥æé«˜ä¸è„šæœ¬ã€ç®¡é“æˆ–ä¸æ”¯æŒANSIé¢œè‰²çš„ç»ˆç«¯çš„å…¼å®¹æ€§ã€‚

- **ç¤ºä¾‹**: `diffai config.json config.new.json --no-color`
- **ç”¨é€”**: æ— é¢œè‰²æ ¼å¼çš„çº¯æ–‡æœ¬è¾“å‡º
- **æ³¨æ„**: åœ¨CI/CDç¯å¢ƒå’Œè‡ªåŠ¨åŒ–è„šæœ¬ä¸­ç‰¹åˆ«æœ‰ç”¨

## MLåˆ†æåŠŸèƒ½

### MLåˆ†æï¼ˆPyTorch/Safetensorsæ–‡ä»¶è‡ªåŠ¨æ‰§è¡Œï¼‰

**å¯¹äºPyTorchï¼ˆ.pt/.pthï¼‰å’ŒSafetensorsï¼ˆ.safetensorsï¼‰æ–‡ä»¶ï¼Œdiffaiä¼šè‡ªåŠ¨æ‰§è¡ŒåŒ…æ‹¬ä»¥ä¸‹å†…å®¹çš„ç»¼åˆåˆ†æï¼š**

#### ç»¼åˆåˆ†æå¥—ä»¶ï¼ˆ30+åŠŸèƒ½ï¼‰

- **åŸºç¡€ç»Ÿè®¡**: æ¯ä¸ªå¼ é‡çš„å¹³å‡å€¼ã€æ ‡å‡†å·®ã€æœ€å°/æœ€å¤§å€¼ã€å½¢çŠ¶ã€æ•°æ®ç±»å‹
- **é‡åŒ–åˆ†æ**: å‹ç¼©æ¯”ä¾‹ã€ç²¾åº¦æŸå¤±åˆ†æ
- **æ¶æ„æ¯”è¾ƒ**: ç»“æ„æ£€æµ‹ã€å±‚æ·±åº¦æ¯”è¾ƒã€è¿ç§»è¯„ä¼°
- **å†…å­˜åˆ†æ**: å†…å­˜å¢é‡ã€å³°å€¼ä½¿ç”¨ä¼°ç®—ã€ä¼˜åŒ–å»ºè®®
- **å¼‚å¸¸æ£€æµ‹**: NaN/Infæ£€æµ‹ã€æ¢¯åº¦çˆ†ç‚¸/æ¶ˆå¤±åˆ†æ
- **æ”¶æ•›åˆ†æ**: å‚æ•°ç¨³å®šæ€§ã€æ—©åœå»ºè®®
- **æ¢¯åº¦åˆ†æ**: æ¢¯åº¦æµå¥åº·åº¦ã€èŒƒæ•°ä¼°ç®—ã€é—®é¢˜å±‚
- **å˜åŒ–æ‘˜è¦**: å¹…åº¦åˆ†æã€æ¨¡å¼ã€å±‚æ’å
- **ç›¸ä¼¼åº¦çŸ©é˜µ**: å±‚é—´ç›¸ä¼¼åº¦ã€èšç±»ç³»æ•°
- **éƒ¨ç½²å‡†å¤‡**: ç”Ÿäº§éƒ¨ç½²å®‰å…¨æ€§è¯„ä¼°
- **é£é™©è¯„ä¼°**: å˜åŒ–å½±å“è¯„ä¼°
- **æ€§èƒ½å½±å“**: é€Ÿåº¦å’Œæ•ˆç‡åˆ†æ
- **å‚æ•°æ•ˆç‡**: ä¼˜åŒ–æœºä¼š
- **å›å½’æµ‹è¯•**: è´¨é‡ä¿è¯éªŒè¯
- **å­¦ä¹ è¿›åº¦**: è®­ç»ƒè¿›åº¦è·Ÿè¸ª
- **åµŒå…¥åˆ†æ**: è¯­ä¹‰æ¼‚ç§»æ£€æµ‹
- **æ³¨æ„åŠ›åˆ†æ**: Transformeræ³¨æ„åŠ›æ¨¡å¼åˆ†æ
- **ç»Ÿè®¡æ˜¾è‘—æ€§**: å˜åŒ–æ˜¾è‘—æ€§æµ‹è¯•
- **è¿ç§»å­¦ä¹ åˆ†æ**: å¾®è°ƒæ•ˆæœ
- **é›†æˆåˆ†æ**: å¤šæ¨¡å‹æ¯”è¾ƒ
- **è¶…å‚æ•°å½±å“**: é…ç½®å˜åŒ–æ•ˆæœ
- **å­¦ä¹ ç‡åˆ†æ**: ä¼˜åŒ–è°ƒåº¦æ•ˆæœ
- **ç­‰ç­‰æ›´å¤š...**

**ğŸ¯ æ— éœ€æ ‡å¿—** - ä¸ºäº†è·å¾—æœ€ä½³ç”¨æˆ·ä½“éªŒï¼Œæ‰€æœ‰åˆ†æéƒ½ä¼šè‡ªåŠ¨æ‰§è¡Œã€‚

**ç¤ºä¾‹**: åªéœ€è¿è¡Œ `diffai model1.safetensors model2.safetensors` å³å¯è·å¾—ç»¼åˆåˆ†æã€‚

## è¾“å‡ºç¤ºä¾‹

### CLIè¾“å‡ºï¼ˆé»˜è®¤ - å®Œæ•´åˆ†æï¼‰

```bash
$ diffai model_v1.safetensors model_v2.safetensors
anomaly_detection: type=none, severity=none, action="continue_training"
architecture_comparison: type1=feedforward, type2=feedforward, deployment_readiness=ready
convergence_analysis: status=converging, stability=0.92
gradient_analysis: flow_health=healthy, norm=0.021069
memory_analysis: delta=+0.0MB, efficiency=1.000000
quantization_analysis: compression=0.0%, speedup=1.8x, precision_loss=1.5%
regression_test: passed=true, degradation=-2.5%, severity=low
deployment_readiness: readiness=0.92, risk=low, timeline=ready_for_immediate_deployment
  ~ fc1.bias: mean=0.0018->0.0017, std=0.0518->0.0647
  ~ fc1.weight: mean=-0.0002->-0.0001, std=0.0514->0.0716
  ~ fc2.bias: mean=-0.0076->-0.0257, std=0.0661->0.0973
  ~ fc2.weight: mean=-0.0008->-0.0018, std=0.0719->0.0883
  ~ fc3.bias: mean=-0.0074->-0.0130, std=0.1031->0.1093
  ~ fc3.weight: mean=-0.0035->-0.0010, std=0.0990->0.1113
```

### ç»¼åˆåˆ†æçš„å¥½å¤„

- **30+åˆ†æåŠŸèƒ½**è‡ªåŠ¨è¿è¡Œ
- **æ— éœ€é€‰æ‹©é€‰é¡¹** - é»˜è®¤è·å¾—æ‰€æœ‰æ´å¯Ÿ
- **ç›¸åŒå¤„ç†æ—¶é—´** - æ— æ€§èƒ½æŸå¤±
- **ç”Ÿäº§å°±ç»ªæ´å¯Ÿ** - éƒ¨ç½²å‡†å¤‡ã€é£é™©è¯„ä¼°ç­‰

### ç§‘å­¦æ•°æ®åˆ†æï¼ˆè‡ªåŠ¨ï¼‰

```bash
$ diffai experiment_data_v1.npy experiment_data_v2.npy
  ~ data: shape=[1000, 256], mean=0.1234->0.1456, std=0.9876->0.9654, dtype=float64
```

### MATLABæ–‡ä»¶æ¯”è¾ƒï¼ˆè‡ªåŠ¨ï¼‰

```bash
$ diffai simulation_v1.mat simulation_v2.mat
  ~ results: var=results, shape=[500, 100], mean=2.3456->2.4567, std=1.2345->1.3456, dtype=double
  + new_variable: var=new_variable, shape=[100], dtype=single, elements=100, size=0.39KB
```

### JSONè¾“å‡º

```bash
$ diffai model_v1.safetensors model_v2.safetensors --output json
[
  {
    "TensorStatsChanged": [
      "fc1.bias",
      {"mean": 0.0018, "std": 0.0518, "shape": [64], "dtype": "f32"},
      {"mean": 0.0017, "std": 0.0647, "shape": [64], "dtype": "f32"}
    ]
  }
]
```

### YAMLè¾“å‡º

```bash
$ diffai model_v1.safetensors model_v2.safetensors --output yaml
- TensorStatsChanged:
  - fc1.bias
  - mean: 0.0018
    std: 0.0518
    shape: [64]
    dtype: f32
  - mean: 0.0017
    std: 0.0647
    shape: [64]
    dtype: f32
```

## é€€å‡ºä»£ç 

- **0**: æˆåŠŸ - æ‰¾åˆ°å·®å¼‚æˆ–æ— å·®å¼‚
- **1**: é”™è¯¯ - æ— æ•ˆå‚æ•°æˆ–æ–‡ä»¶è®¿é—®é—®é¢˜
- **2**: è‡´å‘½é”™è¯¯ - å†…éƒ¨å¤„ç†å¤±è´¥

## ç¯å¢ƒå˜é‡

- **DIFFAI_LOG_LEVEL**: æ—¥å¿—çº§åˆ« (error, warn, info, debug)
- **DIFFAI_MAX_MEMORY**: æœ€å¤§å†…å­˜ä½¿ç”¨é‡ (MBä¸ºå•ä½)

## æ€§èƒ½è€ƒè™‘

- **å¤§æ–‡ä»¶**: diffaiå¯¹GB+æ–‡ä»¶ä½¿ç”¨æµå¤„ç†
- **å†…å­˜ä½¿ç”¨**: å¯é€šè¿‡`DIFFAI_MAX_MEMORY`é…ç½®å†…å­˜é™åˆ¶
- **å¹¶è¡Œå¤„ç†**: å¤šæ–‡ä»¶æ¯”è¾ƒçš„è‡ªåŠ¨å¹¶è¡ŒåŒ–
- **ç¼“å­˜**: é‡å¤æ¯”è¾ƒçš„æ™ºèƒ½ç¼“å­˜

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **"Binary files differ"æ¶ˆæ¯**: ä½¿ç”¨`--format`æŒ‡å®šæ–‡ä»¶ç±»å‹
2. **å†…å­˜ä¸è¶³**: è®¾ç½®`DIFFAI_MAX_MEMORY`ç¯å¢ƒå˜é‡
3. **å¤„ç†ç¼“æ…¢**: åˆ†æå·²é’ˆå¯¹å¤§æ¨¡å‹è‡ªåŠ¨ä¼˜åŒ–
4. **ç¼ºå°‘ä¾èµ–**: ç¡®ä¿Rustå·¥å…·é“¾å·²æ­£ç¡®å®‰è£…

### è°ƒè¯•æ¨¡å¼

å¯ç”¨è°ƒè¯•è¾“å‡ºï¼š
```bash
DIFFAI_LOG_LEVEL=debug diffai model1.safetensors model2.safetensors
```

## ç›¸å…³æ–‡æ¡£

- [åŸºæœ¬ç”¨æ³•æŒ‡å—](../user-guide/basic-usage_zh.md)
- [MLæ¨¡å‹æ¯”è¾ƒæŒ‡å—](../user-guide/ml-model-comparison_zh.md)
- [ç§‘å­¦æ•°æ®åˆ†ææŒ‡å—](../user-guide/scientific-data_zh.md)
- [è¾“å‡ºæ ¼å¼å‚è€ƒ](output-formats_zh.md)
- [æ”¯æŒæ ¼å¼å‚è€ƒ](formats_zh.md)